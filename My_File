Mockito.when(getCircuitBreaker.getMetrics()).thenReturn(circuitBreakerMetrics);
    Mockito.when(postCircuitBreaker.getMetrics()).thenReturn(circuitBreakerMetrics);

    // Stub Metrics methods
    Mockito.when(circuitBreakerMetrics.getFailureRate()).thenReturn(0.0f);
    Mockito.when(circuitBreakerMetrics.getNumberOfBufferedCalls()).thenReturn(10);
    Mockito.when(circuitBreakerMetrics.getNumberOfFailedCalls()).thenReturn(2);
    Mockito.when(circuitBreakerMetrics.getNumberOfSlowCalls()).thenReturn(1);
    Mockito.when(circuitBreakerMetrics.getNumberOfSuccessfulCalls()).thenReturn(7);

    // Also stub CircuitBreaker state and config
    Mockito.when(getCircuitBreaker.getState()).thenReturn(CircuitBreaker.State.CLOSED);
    Mockito.when(postCircuitBreaker.getState()).thenReturn(CircuitBreaker.State.CLOSED);
    Mockito.when(getCircuitBreaker.getCircuitBreakerConfig()).thenReturn(null);
    Mockito.when(postCircuitBreaker.getCircuitBreakerConfig()).thenReturn(null);
